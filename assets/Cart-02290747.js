import{u as F,r as l,e as L,j as e,a2 as G,b as _,Q as C,L as $,O as Q}from"./index-6423e628.js";import{P as D}from"./PaymentMethods-364aaceb.js";/* empty css              */import Y from"./DeleteModal-5d9d1c33.js";const M=({id:a,title:o,image:j,price:u,quantity:w,quantityOnStock:r,productTotalPrice:b,setCartItems:g,openDeleteModal:k,setDeleteProductId:y})=>{const{i18n:c}=F(),[d,x]=l.useState(w),h=JSON.parse(localStorage.getItem("userToken")),{getTotalPriceInCart:s,getCartItems:m,total:E,mainRequest:N}=l.useContext(L),p=async(n,i,v)=>{try{const t=await N.post(`${_}/cart/update`,{token:h,product_id:n,quantity:i});C.success(c.language==="en"?"Update Successfully":"تم تعديل الكمية"),s(),m(h,v)}catch(t){console.log(t)}},I=()=>{d!==r&&(x(n=>n+1),p(a,d+1,g))},S=()=>{d!==1&&(x(n=>n-1),p(a,d-1,g))},q=n=>{const i=parseInt(n.target.value);isNaN(i)||i<1||i>r||x(i)};return e.jsxs("div",{className:"cart-item w-full flex flex-col md:flex-row justify-between gap-3 border-b ",children:[e.jsx("div",{className:"img-holder w-48 h-48",children:e.jsx("img",{className:"w-full h-full object-cover",src:`https://admin.horriizon.com/public/${j}`,alt:c.language==="en"?o.en:o.ar})}),e.jsxs("div",{className:"details flex-1 grid gap-3",children:[e.jsx("h3",{className:"font-bold text-xl",children:o}),e.jsx("p",{children:c.language==="en"?`quantity in stock : ${r}`:`الكميه المتاحه : ${r}`}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("label",{className:"font-bold",htmlFor:"quantity",children:c.language==="en"?"Quantity:":"الكمية:"}),e.jsxs("div",{className:"quantity-control flex items-center",children:[e.jsx("button",{className:"quantity-button py-2 px-3 text-xl font-medium",onClick:S,children:"-"}),e.jsx("input",{type:"number",name:"quantity",min:1,max:r,id:"quantity",className:"border-none focus:outline-none bg-transparent w-20 text-center",value:d,onChange:q,onBlur:n=>{p(a,parseInt(n.target.value),g)}}),e.jsx("button",{className:"quantity-button py-2 px-3 text-xl font-medium",onClick:I,children:"+"})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h4",{className:"text-xl font-bold text-secondColor",children:`${c.language==="ar"?`جنية ${b}`:`${b} EGY`} `||"0 EGY"}),e.jsx("div",{className:"actions",children:e.jsx("button",{className:"text-2xl text-secondColor p-1 border border-secondColor hover:bg-mainColor hover:border-mainColor hover:text-white duration-200 hover:scale-125",onClick:()=>{k(),y(a)},children:e.jsx(G,{})})})]})]})]},a)},B=()=>{var i,v;const{i18n:a}=F(),o=JSON.parse(localStorage.getItem("userToken")),j=localStorage.getItem("userLogged"),[u,w]=l.useState(0),[r,b]=l.useState(""),[g,k]=l.useState(0);l.useState();const[y,c]=l.useState(),{getCartItems:d,getTotalPriceInCart:x,total:h,cartItems:s,setCartItems:m,mainRequest:E}=l.useContext(L);l.useEffect(()=>{j&&o&&(x(),d(o,m,c))},[j,o,h]),l.useEffect(()=>{(()=>{w(h+g)})()},[s,g]);const[N,p]=l.useState(!1),[I,S]=l.useState(null),q=()=>{p(!0)},n=async t=>{if(t.preventDefault(),!r){C.info(a.language==="en"?"Enter the coupon":"قم بإدخال القسيمه");return}try{(await E.post(`${_}/coupon/${r}`,{token:o})).data==="Coupon Not Found"&&C.info(a.language==="en"?"Coupon Not Found":"لم يتم العثور على القسيمة")}catch(f){C.error(a.language==="en"?"theres is an error, please try again":"يوجد خطأ، برجاء المحاوله مره اخره"),console.log(f)}x(),d(o,m,c)};return!y&&((i=s[1])==null?void 0:i.length)===0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"container py-10 flex flex-col gap-5 items-center justify-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:a.language==="en"?"Your Cart Is Empty!":"عربة التسوق فارغة!"}),e.jsx("img",{className:"w-1/4",src:"https://img.icons8.com/?size=512&id=108807&format=png",alt:"empty cart"}),e.jsx($,{to:"/all-products",className:"bg-mainColor text-white px-5 py-2 shadow-lg rounded-lg hover:bg-secondColor duration-200 hover:translate-x-4",children:a.language==="en"?"Go to All Products":"جميع المنتجات"})]}),e.jsx(D,{})]}):e.jsxs(e.Fragment,{children:[N&&e.jsx(Y,{setIsLoading:c,deleteModal:N,setDeleteModal:p,productId:I}),e.jsxs("div",{className:"container py-10",children:[y&&e.jsx("div",{className:"loading-overlay",children:e.jsx(Q,{visible:!0,height:"160",width:"160",ariaLabel:"Oval-loading",color:"#125ed4",secondaryColor:"#060047"})}),e.jsxs("div",{className:"grid grid-cols-3 gap-5",children:[e.jsx("div",{className:"col-span-3 lg:col-span-2 flex flex-col gap-3",children:(v=s[1])==null?void 0:v.map(t=>{var f,T,P;return e.jsx(M,{id:t.id,setCartItems:m,title:a.language==="en"?(f=t==null?void 0:t.title)==null?void 0:f.en:(T=t==null?void 0:t.title)==null?void 0:T.ar,image:t.images[0].path,price:t.price,productTotalPrice:(P=t==null?void 0:t.quantity_of_cart)==null?void 0:P.total,total_price:t.total_price,quantity:t.quantity_of_cart.quantity,quantityOnStock:t.quantity,openDeleteModal:q,setDeleteProductId:S,cartItem:!0},t.id)})}),e.jsxs("div",{className:"col-span-3 lg:col-span-1 lg:sticky top-0 h-fit",children:[e.jsxs("form",{className:`coupon-form relative overflow-hidden flex flex-col items-start gap-6 bg-[#F4DBE8] py-4 px-6 rounded-lg shadow-md ${u<s[0]?"before:absolute before:inset-0 before:bg-gray-400 before:bg-opacity-50":""}`,onSubmit:t=>n(t),children:[e.jsx("label",{htmlFor:"coupon",className:"font-bold",children:a.language==="en"?"Have a Coupon?":"هل لديك قسيمة؟"}),e.jsx("input",{disabled:u<s[0],className:"w-full rounded-lg",placeholder:a.language==="en"?"add your coupon":"أضف قسيمتك",type:"text",name:"coupon",id:"coupon",value:r,onChange:t=>b(t.target.value)}),e.jsx("button",{disabled:u<s[0],onClick:t=>n(t),className:"m-0 px-5 bg-secondColor py-2 rounded-md text-white hover:brightness-110",type:"submit",children:a.language==="en"?"Apply Coupon":"تطبيق القسيمة"})]}),e.jsxs("div",{className:"cart-total flex flex-col gap-6 py-4 px-6 mt-5",children:[e.jsx(e.Fragment,{}),u<s[0]&&e.jsxs("div",{className:"flex justify-between items-center gap-6 text-red-500 line-through",children:[e.jsx("h3",{className:"",children:a.language==="en"?"Total products Price":"مجموع المنتجات"}),e.jsxs("p",{className:"flex-1 text-end",children:[s[0]," EGY"]})]}),u<s[0]&&e.jsxs("div",{className:"flex justify-between items-center gap-6",children:[e.jsx("h3",{className:"",children:a.language==="en"?"Discount":"خصم"}),e.jsxs("p",{className:"flex-1 text-end",children:["-",s[0]-u," EGY"]})]}),e.jsxs("div",{className:"flex justify-between items-center gap-6",children:[e.jsx("h3",{className:"",children:a.language==="en"?"Total":"المجموع الكلي"}),e.jsxs("p",{className:"flex-1 text-end",children:[u," EGY"]})]}),e.jsx($,{to:"/checkout",className:"text-center m-0 px-5 bg-secondColor py-2 rounded-md text-white hover:bg-mainColor duration-200 hover:-translate-y-1",type:"button",children:a.language==="en"?"Checkout":"الدفع"})]})]})]})]}),e.jsx(D,{})]})};export{B as default};
