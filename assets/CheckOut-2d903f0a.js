import{u as k,j as e,c as A,r as o,A as U,D as Y,Q as y,b as z}from"./index-07f41fe7.js";import{k as J}from"./index.esm-df1806d8.js";/* empty css              */import{S as Q}from"./react-select.esm-d8856045.js";import"./iconBase-1692c05c.js";import"./toConsumableArray-8cfbb2bf.js";import"./floating-ui.dom.browser.min-b2afe59a.js";const B=({title:c,price:a,productTotalPrice:h,quantity:p,image:i})=>{const{i18n:d}=k();return e.jsxs("div",{className:"flex justify-between gap-3 border border-gray-300 py-3 px-2 rounded-md shadow-sm",children:[e.jsx("img",{className:"w-20 h-20 object-cover",src:i,alt:d.language==="en"?c.en:c.ar}),e.jsxs("div",{className:"grid flex-1 gap-5",children:[e.jsx("h3",{className:"font-medium",children:d.language==="en"?c.en:c.ar}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("p",{className:"text-gray-500",children:[d.language==="en"?"Quantity : ":"الكمية : ",e.jsx("span",{children:p})]}),e.jsx("span",{children:"*"}),e.jsxs("p",{className:"text-gray-500",children:[d.language==="en"?"Price : ":"السعر : ",e.jsx("span",{children:a})]})]})]}),e.jsx("span",{className:"text-secondColor font-bold",children:`${d.language==="ar"?`جنية ${h}`:`${h} EGY`}`})]})},te=()=>{const c=A(),{i18n:a}=k(),[h,p]=o.useState([]),i=JSON.parse(localStorage.getItem("userToken")),d=localStorage.getItem("userLogged");if(!d)return c("/customer-login"),null;const[u,q]=o.useState(""),[n,b]=o.useState({firstName:"",lastName:"",phoneNumber:"",email:"",address:"",apartment:"",floor:"",street:"",building:"",selectedPaymentMethod:"vodafone-cash",notes:""}),[g,j]=o.useState(null),[N,F]=o.useState(null),{getCartItems:D,getTotalPriceInCart:I,total:x,governorates:v,getGovernorates:M,mainRequest:_,setCartItems:H}=o.useContext(U),C=o.useRef(null),l=t=>{b({...n,[t.target.name]:t.target.value})},w=t=>{b({...n,selectedPaymentMethod:t.target.value})},E=t=>{const s=t.target.files[0];j(s)},G=()=>{C.current.click()},O=()=>{j(null)},[R,f]=o.useState(!1),P=async t=>{t.preventDefault(),f(!0);const s={...n,governorate_id:u.value,city:u.label,token:i};console.log(u);const r=new FormData;if(r.append("token",s.token),r.append("first_name",s.firstName),r.append("last_name",s.lastName),r.append("phone",s.phoneNumber),r.append("email",s.email),r.append("address",s.address),r.append("apartment",s.apartment),r.append("floor",s.floor),r.append("street",s.street),r.append("building",s.building),r.append("governorate_id",s.governorate_id),r.append("city",s.city),r.append("notes",s.notes),r.append("payment_method",s.selectedPaymentMethod==="cash-on-delivery"?0:1),r.append("vodafone_cash_number",N),r.append("photo",g),console.log(u),!Object.values(s).every(m=>m)){y.info(a.language==="en"?"Please fill all fields":"من فضلك ادخل جميع البيانات"),f(!1);return}try{const m=await _.post(`${z}/payment`,r);y.success(a.language==="en"?"Your Oreder Succsesfly Done":"تم ارسال طلبك بنجاح"),c("/")}catch(m){console.log(m),y.error(a.language==="en"?"Something went wrong":"حدث خطأ ما, من فضلك حاول مرة اخري")}finally{f(!1)}};o.useEffect(()=>{d&&i&&(I(),D(i,p))},[d,i,x]);const L=v.map(t=>({value:t.id,label:t.title.en})),T=v.map(t=>({value:t.id,label:t.title.ar}));return o.useEffect(()=>{M()},[]),e.jsxs("div",{className:"container py-10",children:[R&&e.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-[#F4F4F4] bg-opagovernorate_id-60 z-50",children:e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:e.jsx(Y,{visible:!0,height:"260",width:"260",ariaLabel:"dna-loading",wrapperStyle:{},wrapperClass:"dna-wrapper"})})}),e.jsxs("form",{onSubmit:P,className:"grid grid-cols-1 lg:grid-cols-2 gap-6 relative",children:[e.jsxs("div",{className:"grid gap-3 lg:sticky top-0 h-fit",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-mainColor font-bold text-lg",children:"Payment Method"}),e.jsx("p",{className:"text-gray-500",children:"Select the number for payment of your item"})]}),e.jsxs("div",{className:"flex justify-between items-center rounded-lg border border-gray-500 p-2",children:[e.jsx("label",{className:"flex-1 cursor-pointer",htmlFor:"vodafone-cash",children:a.language==="en"?"vodafone Cash":"فودافون كاش"}),e.jsx("input",{className:"cursor-pointer",type:"radio",name:"selectedPaymentMethod",id:"vodafone-cash",value:"vodafone-cash",checked:n.selectedPaymentMethod==="vodafone-cash",onChange:w})]}),e.jsxs("div",{className:"flex justify-between items-center rounded-lg border border-gray-500 p-2",children:[e.jsx("label",{className:"flex-1 cursor-pointer",htmlFor:"cash-on-delivery",children:a.language==="en"?"Cash on Delivery":"الدفع عند الاستلام"}),e.jsx("input",{className:"cursor-pointer",type:"radio",name:"selectedPaymentMethod",id:"cash-on-delivery",value:"cash-on-delivery",checked:n.selectedPaymentMethod==="cash-on-delivery",onChange:w})]})]}),n.selectedPaymentMethod!=="cash-on-delivery"&&e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-mainColor font-bold text-lg",children:"Transfer data"}),e.jsx("p",{className:"text-gray-500",children:"Select the image for the conversion"})]}),e.jsxs("div",{className:"flex items-center flex-col gap-2 justify-center",children:[e.jsxs("div",{className:"w-full flex gap-2 flex-col",children:[e.jsx("label",{htmlFor:"cashNumber",children:"Enter Your Cash Number"}),e.jsx("input",{placeholder:a.language==="ar"?"رقم المفظة الالكترونية":"Cash Number",className:"rounded-lg border-gray-300 shadow-md",type:"tel",id:"cashNumber",name:"cashNumber",value:N,onChange:t=>{F(t.target.value)},required:n.selectedPaymentMethod!=="cash-on-delivery"})]}),e.jsxs("div",{className:"w-2/3 bg-[#F8F8FF] text-center border-dashed border-2 rounded-lg border-gray-300 p-4",children:[g?e.jsxs("div",{children:[e.jsx("img",{src:URL.createObjectURL(g),alt:"Transfer photo",className:"w-20 h-20 mx-auto mb-2"}),e.jsx("span",{className:"text-secondColor font-bold border-b border-b-secondColor",children:"Photo Selected"}),e.jsxs("div",{className:"flex justify-center mt-2",children:[e.jsx("button",{type:"button",className:"bg-mainColor text-white py-1 px-2 rounded-lg mr-2",onClick:G,children:"Update Photo"}),e.jsx("button",{type:"button",className:"bg-red-500 text-white py-1 px-2 rounded-lg",onClick:O,children:"Delete Photo"})]})]}):e.jsxs("label",{htmlFor:"photoInput",className:"flex flex-col items-center justify-center",children:[e.jsx(J,{className:"text-[4rem]"}),e.jsx("span",{className:"text-secondColor font-bold border-b border-b-secondColor cursor-pointer",children:"Select Photo"})]}),e.jsx("input",{ref:C,id:"photoInput",type:"file",accept:".jpg,.jpeg,.png",className:"hidden",onChange:E,required:n.selectedPaymentMethod!=="cash-on-delivery"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Supported formats: JPEG, PNG"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-mainColor font-bold text-lg",children:"Personal Details"}),e.jsx("p",{className:"text-gray-500",children:"Complete personal details to continue the payment"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[e.jsx("input",{placeholder:a.language==="en"?"First Name":"الاسم الاول",className:"rounded-lg border-gray-300 shadow-md",type:"text",name:"firstName",value:n.firstName,onChange:l,required:!0}),e.jsx("input",{placeholder:a.language==="en"?"Last Name":"الاسم الاخير",className:"rounded-lg border-gray-300 shadow-md",type:"text",name:"lastName",value:n.lastName,onChange:l,required:!0}),e.jsx("input",{placeholder:a.language==="en"?"Phone Number":"رقم الهاتف",className:"rounded-lg border-gray-300 shadow-md",type:"tel",name:"phoneNumber",value:n.phoneNumber,onChange:l,required:!0}),e.jsx("input",{placeholder:a.language==="en"?"Email":"البريد الالكتروني",className:"rounded-lg border-gray-300 shadow-md",type:"email",name:"email",value:n.email,onChange:l,required:!0}),e.jsx(Q,{name:"governorate",id:"governorate",className:"rounded-lg border-gray-300 shadow-md col-span-2",onChange:t=>q(t),options:a.language==="en"?L:T,placeholder:a.language==="ar"?"ادخل محافظتك":"enter your Governorate",isRtl:a.language==="ar",isSearchable:!0,required:!0}),e.jsx("input",{placeholder:a.language==="ar"?"عنوانك":"Address",className:"rounded-lg border-gray-300 shadow-md col-span-2",type:"text",name:"address",value:n.address,onChange:l,required:!0}),e.jsx("input",{placeholder:a.language==="ar"?"الشارع":"Street",className:"rounded-lg border-gray-300 shadow-md col-span-2",type:"text",name:"street",value:n.street,onChange:l,required:!0}),e.jsxs("div",{className:"grid col-span-2 grid-cols-3 gap-2",children:[e.jsx("input",{placeholder:a.language==="ar"?"المبنى":"Building",className:"rounded-lg border-gray-300 shadow-md",type:"text",name:"building",value:n.building,onChange:l,required:!0}),e.jsx("input",{placeholder:a.language==="ar"?"الشقة":"floor",className:"rounded-lg border-gray-300 shadow-md",type:"text",name:"floor",value:n.floor,onChange:l,required:!0}),e.jsx("input",{placeholder:a.language==="ar"?"الشقة":"Apartment",className:"rounded-lg border-gray-300 shadow-md",type:"text",name:"apartment",value:n.apartment,onChange:l,required:!0})]}),e.jsx("textarea",{name:"notes",id:"notes",value:n.notes,onChange:l,placeholder:a.language==="en"?"enter short note":"اترك ملاحظة",className:"rounded-lg border-gray-300 shadow-md col-span-2 resize-y min-h-[5rem] max-h-[10rem]"})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 sticky top-44 left-0 h-fit",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-mainColor font-bold text-lg",children:"Current Order"}),e.jsx("p",{className:"text-gray-500",children:"The sum of all total payments for goods there"})]}),h.map(t=>{const{id:s,title:r,images:m,price:$,quantity_of_cart:S}=t;return e.jsx(B,{quantity:S.quantity,title:r,price:$,productTotalPrice:S.total,image:`https://admin.horriizon.com/public/assets/${m[0].path}`},s)}),e.jsxs("div",{className:"flex justify-between items-center font-medium py-4 border-dotted border-b-2",children:[e.jsx("h6",{children:"Subtotal"}),e.jsxs("p",{children:[x," EGY"]})]}),e.jsxs("button",{type:"submit",className:"bg-secondColor text-white text-xl py-2 px-4 rounded-md",onClick:P,children:["Pay ",x," EGY"]})]})]})]})};export{te as default};
