import{r as i,f as ve,u as Ce,e as Pe,j as e,y as U,g as oe,h as re,a as A,b as G,Q as u}from"./index-90b8ff94.js";import{B as ie}from"./index.esm-e618f9ae.js";import{B as ce}from"./Breadcrumbs-ee1f4a4a.js";import{S as w}from"./Tooltip-a3eae287.js";import{S as Se}from"./react-select.esm-c0722918.js";import{u as de}from"./user-image-placeholder-50f80e46.js";import{L as ke}from"./Loading-5a3634ce.js";import"./index.esm-cd81285c.js";import"./floating-ui.dom-9d44cd4e.js";import"./toConsumableArray-efda5d7e.js";import"./emotion-unitless.esm-475d8cc4.js";const Be=()=>{const o=localStorage.getItem("userLogged"),g=JSON.parse(localStorage.getItem("userToken"));JSON.parse(localStorage.getItem("providerId"));const[t,v]=i.useState({}),[ue,q]=i.useState(!1),C=localStorage.getItem("sellerLogged"),m=JSON.parse(localStorage.getItem("sellerToken")),[l,P]=i.useState({}),ge=ve(),{i18n:a}=Ce(),{getUserInfo:S,getSellerInfo:k,logout:M,governorates:I,getGovernorates:me}=i.useContext(Pe);if(!o&&!C)return ge("/customer-login"),null;const[Q,V]=i.useState(!1),[H,R]=i.useState(!1),[f,he]=i.useState(!1),[n,D]=i.useState(!1),[B,E]=i.useState(!1),[h,d]=i.useState(o?t==null?void 0:t.name:l==null?void 0:l.name),[p,j]=i.useState(o?t==null?void 0:t.email:l==null?void 0:l.email),[x,b]=i.useState(o?t==null?void 0:t.phone:l==null?void 0:l.phone),[F,pe]=i.useState(l==null?void 0:l.cash_number),[y,xe]=i.useState(""),[N,fe]=i.useState(""),[je,be]=i.useState(""),O=()=>{he(!f)},L=()=>{D(!n),E(!1)},T=()=>{E(!B),D(!1)},K=s=>{d(s.target.value)},J=s=>{j(s.target.value)},W=s=>{b(s.target.value)},we=s=>{pe(s.target.value)},X=s=>{xe(s.target.value)},Y=s=>{fe(s.target.value)},_=async s=>{s.preventDefault(),V(!0);try{const r={token:o?g:m,name:o?h||t.name:h||l.name,email:o?p||t.email:p||l.email,phone:o?x||t.phone:x||l.phone,governorate_id:je||l.governorate_id,cash_number:F},z=await A.post(`${G}${o?"/auth/user-update":"/vendor/auth/vendor-update"}`,r);u.success(a.language==="en"?"The profile updated successfully":"تم تحديث الملف الشخصي بنجاح")}catch{u.error(a.language==="en"?"There is an error, please try again later":"يوجد خطأ ما، الرجاء المحاولة مره اخري")}finally{V(!1),D(!1),o?S(g,v,d,j,b):k(m,P,d,j,b)}},$=async s=>{if(s.preventDefault(),!y){u.info(a.language==="en"?"please enter new password":"ادخل كلمة المرور الجديده");return}if(!N){u.info(a.language==="en"?"please enter confirmation password":"ادخل تاكيد كلمة المرور");return}if(y!==N){u.info(a.language==="en"?"password and confirmation password not match":"كلمة المرور وتاكيد كلمة المرور غير متطابقين");return}R(!0);try{const r={token:o?g:m,name:o?h||t.name:h||l.name,email:o?p||t.email:p||l.email,phone:o?x||t.phone:x||l.phone,governorate_id:l.governorate_id,cash_number:F,password:y,password_confirmation:N},z=await A.post(`${G}${o?"/auth/user-update":"/vendor/auth/vendor-update"}`,r);u.success("The password updated successfully")}catch{u.error(a.language==="en"?"There is an error, please try again later":"يوجد خطأ ما، الرجاء المحاولة مره اخري")}finally{R(!1),E(!1),o?S(g,v,d,j,b):k(m,P,d)}},Z=i.useRef(null),[c,ee]=i.useState(null),[ae,se]=i.useState(!1),le=s=>{const r=s.target.files[0];ee({...c,photo:r})},te=async s=>{s.preventDefault(),se(!0);const r={token:o?g:m,image:c.photo,name:o?h||t.name:h||l.name,email:o?p||t.email:p||l.email,phone:o?x||t.phone:x||l.phone,governorate_id:l.governorate_id,cash_number:F};try{const z=await A.post(`${G}${o?"/auth/user-update":"/vendor/auth/vendor-update"}`,r,{headers:{"Content-Type":"multipart/form-data"}});u.success(a.language==="en"?"The photo updated successfully":"تم تحديث الصورة بنجاح")}catch{u.error(a.language==="en"?"There is an error, please try again later":"يوجد خطأ ما، الرجاء المحاولة مره اخري")}finally{R(!1),E(!1),se(!1),o?S(g,v,d,j,b):k(m,P,d)}},ne=()=>{ee({...c,photo:null})};i.useEffect(()=>{o&&S(g,v,d,j,b,q)},[o,g]),i.useEffect(()=>{C&&k(m,P,d,j,b,q)},[C,m]);const ye=I.map(s=>({value:s.id,label:s.title.en})),Ne=I.map(s=>({value:s.id,label:s.title.ar}));if(i.useEffect(()=>{me()},[]),ue)return e.jsx(ke,{});if(o)return e.jsxs("div",{className:"container py-10",children:[e.jsx("div",{className:"mb-10",children:e.jsx(ce,{})}),e.jsxs("div",{className:"grid grid-cols-3 gap-5 my-5",children:[e.jsxs("div",{className:"user-info col-span-3 md:col-span-1 bg-white p-3 shadow-lg rounded-md h-fit",children:[ae?e.jsx("div",{className:"mb-3 flex items-ce justify-center py-3",children:e.jsx(w,{"aria-label":"loading...",color:"purple"})}):e.jsxs("div",{className:"grid mb-3",children:[c!=null&&c.photo?e.jsx(e.Fragment,{children:e.jsx("div",{className:"img-holder relative -top-10 overflow-hidden w-32 h-32 bg-secondColor text-white grid place-content-center rounded-[50%] mx-auto",children:e.jsx("img",{src:URL.createObjectURL(c==null?void 0:c.photo),alt:"Transfer photo",className:"h-full w-full"})})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"img-holder relative -top-10 overflow-hidden w-32 h-32 bg-secondColor text-white grid place-content-center rounded-[50%] mx-auto",children:e.jsx("img",{src:t.image?`https://admin.horriizon.com/public/${t.image}`:de,className:"h-full w-full",alt:t.name})}),e.jsx("label",{htmlFor:"photoInput",className:"flex flex-col items-center justify-center",children:e.jsx("span",{className:"text-secondColor font-bold border-b border-b-secondColor cursor-pointer",children:a.language==="en"?"Upload New Image":"تحديث الصورة"})}),e.jsx("input",{ref:Z,id:"photoInput",type:"file",accept:".jpg,.jpeg,.png",className:"hidden",onChange:le})]}),(c==null?void 0:c.photo)&&e.jsx("div",{children:e.jsxs("div",{className:"flex justify-center gap-3",children:[e.jsx("button",{type:"button",className:"bg-mainColor text-white py-1 px-2 rounded-lg mr-2",onClick:te,children:a.language==="en"?"Save":"حفظ"}),e.jsx("button",{type:"button",className:"bg-red-500 text-white py-1 px-2 rounded-lg",onClick:ne,children:a.language==="en"?"Close":"اغلاق"})]})})]}),e.jsxs("div",{className:"info flex flex-col justify-center items-center gap-3",children:[e.jsx("h3",{children:t.name}),e.jsx("h3",{className:"text-sm md:text-md",children:t.email})]}),e.jsxs("div",{className:"actions mt-10 flex flex-col justify-center items-center gap-3",children:[e.jsxs("button",{className:"flex items-center gap-2",onClick:L,children:[e.jsx(U,{})," ",a.language==="en"?"Edit Profile":"تعديل بياناتك"]}),e.jsxs("button",{className:"flex items-center gap-2",onClick:T,children:[e.jsx(U,{})," ",a.language==="en"?"Edit Password":"تغيير كلمة المرور"]}),e.jsxs("button",{onClick:M,className:"flex items-center gap-2",children:[e.jsx(ie,{}),a.language==="en"?"Logout":"تسجيل الخروج"]})]})]}),e.jsxs("div",{className:"col-span-3 md:col-span-2 bg-white p-3 shadow-lg rounded-md h-fit",children:[e.jsx("h2",{className:"text-xl font-medium",children:a.language==="ar"?"الملف الشخصي":"Profile"}),e.jsxs("form",{className:"flex flex-col gap-5 items-center my-5",onSubmit:_,children:[e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col",children:[e.jsx("label",{htmlFor:"name",children:a.language==="ar"?"الاسم":"Full Name"}),e.jsx("input",{className:"w-full bg-gray-300",id:"name",type:"text",value:n?h:t.name,readOnly:!n,onChange:s=>{n&&K(s)}})]}),e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col",children:[e.jsx("label",{htmlFor:"phone",children:a.language==="ar"?"رقم الهاتف":"Phone"}),e.jsx("input",{className:"w-full bg-gray-300",id:"phone",type:"tel",value:n?x:t.phone,readOnly:!n,onChange:s=>{n&&W(s)}})]}),e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col",children:[e.jsx("label",{htmlFor:"email",children:a.language==="ar"?"البريد الالكتروني":"Email"}),e.jsx("input",{className:"w-full bg-gray-300",id:"email",type:"email",value:n?p:t.email,readOnly:!n,onChange:s=>{n&&J(s)}})]}),n&&e.jsxs("div",{className:"w-full grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:_,className:"m-0 bg-secondColor py-2 rounded-xl text-white",type:"submit",children:Q?e.jsx(w,{"aria-label":"loading...",color:"purple"}):a.language==="ar"?"حفظ التعديلات":"Save Changes"}),e.jsx("button",{className:"py-2 rounded-xl border border-secondColor text-secondColor",type:"button",onClick:L,children:a.language==="ar"?"الغاء":"Cancel"})]})]}),B&&e.jsxs("form",{className:"flex flex-col gap-5 items-center my-5",onSubmit:$,children:[e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col relative",children:[e.jsx("label",{htmlFor:"new-password",children:a.language==="ar"?"كلمة المرور الجديده":"New Password"}),e.jsx("input",{className:"w-full bg-gray-300",id:"new-password",type:f?"text":"password",value:y,onChange:X}),f?e.jsx(oe,{className:`absolute ${a.language==="en"?"right-3":"left-3"} top-1/2 transform translate-y-1/2 cursor-pointer`,onClick:O}):e.jsx(re,{className:`absolute ${a.language==="en"?"right-3":"left-3"} top-1/2 transform translate-y-1/2 cursor-pointer`,onClick:O})]}),e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col relative",children:[e.jsx("label",{htmlFor:"confirm-password",children:a.language==="ar"?"اعد كتابة كلمة المرور":"Confirm Password"}),e.jsx("input",{className:"w-full bg-gray-300",id:"confirm-password",type:f?"text":"password",value:N,onChange:Y})]}),e.jsxs("div",{className:"w-full grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:$,className:"m-0 bg-secondColor py-2 rounded-xl text-white",type:"submit",children:H?e.jsx(w,{"aria-label":"loading...",color:"purple"}):a.language==="ar"?"حفظ كلمة المرور":"Uptade Password"}),e.jsx("button",{className:"py-2 rounded-xl border border-secondColor text-secondColor",type:"button",onClick:T,children:a.language==="ar"?"الغاء":"Cancel"})]})]})]})]})]});if(C){const s=I.find(r=>r.id===l.governorate_id);return e.jsxs("div",{className:"container py-10",children:[e.jsx("div",{className:"mb-10",children:e.jsx(ce,{})}),e.jsxs("div",{className:"grid grid-cols-3 gap-5 my-5",children:[e.jsxs("div",{className:"user-info col-span-3 md:col-span-1 bg-white p-3 shadow-lg rounded-md h-fit",children:[ae?e.jsx("div",{className:"mb-3 flex items-ce justify-center py-3",children:e.jsx(w,{"aria-label":"loading...",color:"purple"})}):e.jsxs("div",{className:"grid mb-3",children:[c!=null&&c.photo?e.jsx(e.Fragment,{children:e.jsx("div",{className:"img-holder relative -top-10 overflow-hidden w-32 h-32 bg-secondColor text-white grid place-content-center rounded-[50%] mx-auto",children:e.jsx("img",{src:URL.createObjectURL(c==null?void 0:c.photo),alt:"Transfer photo",className:"h-full w-full"})})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"img-holder relative -top-10 overflow-hidden w-32 h-32 bg-secondColor text-white grid place-content-center rounded-[50%] mx-auto",children:e.jsx("img",{src:t.image?`https://admin.horriizon.com/images/${t.image}`:de,className:"h-full w-full",alt:t.name})}),e.jsx("label",{htmlFor:"photoInput",className:"flex flex-col items-center justify-center",children:e.jsx("span",{className:"text-secondColor font-bold border-b border-b-secondColor cursor-pointer",children:a.language==="en"?"Upload New Image":"تحديث الصورة"})}),e.jsx("input",{ref:Z,id:"photoInput",type:"file",accept:".jpg,.jpeg,.png",className:"hidden",onChange:le})]}),(c==null?void 0:c.photo)&&e.jsx("div",{children:e.jsxs("div",{className:"flex justify-center gap-3",children:[e.jsx("button",{type:"button",className:"bg-mainColor text-white py-1 px-2 rounded-lg mr-2",onClick:te,children:a.language==="en"?"Save":"حفظ"}),e.jsx("button",{type:"button",className:"bg-red-500 text-white py-1 px-2 rounded-lg",onClick:ne,children:a.language==="en"?"Close":"اغلاق"})]})})]}),e.jsxs("div",{className:"info flex flex-col justify-center items-center gap-3",children:[e.jsx("h3",{children:l.name}),e.jsx("h3",{className:"text-sm md:text-md",children:l.email})]}),e.jsxs("div",{className:"actions mt-10 flex flex-col justify-center items-center gap-3",children:[e.jsxs("button",{className:"flex items-center gap-2",onClick:L,children:[e.jsx(U,{})," ",a.language==="en"?"Edit Profile":"تعديل بياناتك"]}),e.jsxs("button",{className:"flex items-center gap-2",onClick:T,children:[e.jsx(U,{})," ",a.language==="en"?"Edit Password":"تغيير كلمة المرور"]}),e.jsxs("button",{onClick:M,className:"flex items-center gap-2",children:[e.jsx(ie,{}),a.language==="en"?"Logout":"تسجيل الخروج"]})]})]}),e.jsxs("div",{className:"col-span-3 md:col-span-2 bg-white p-3 shadow-lg rounded-md h-fit",children:[e.jsx("h2",{className:"text-xl font-medium",children:a.language==="ar"?"الملف الشخصي":"Profile"}),e.jsxs("form",{className:"flex flex-col gap-5 items-center my-5",onSubmit:_,children:[e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col",children:[e.jsx("label",{htmlFor:"name",children:a.language==="ar"?"الاسم":"Full Name"}),e.jsx("input",{className:"w-full bg-gray-300",id:"name",type:"text",value:n?h:l.name,readOnly:!n,onChange:r=>{n&&K(r)}})]}),e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col",children:[e.jsx("label",{htmlFor:"phone",children:a.language==="ar"?"رقم الهاتف":"Phone"}),e.jsx("input",{className:"w-full bg-gray-300",id:"phone",type:"tel",value:n?x:l.phone,readOnly:!n,onChange:r=>{n&&W(r)}})]}),e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col",children:[e.jsx("label",{htmlFor:"email",children:a.language==="ar"?"البريد الالكتروني":"Email"}),e.jsx("input",{className:"w-full bg-gray-300",id:"email",type:"email",value:n?p:l.email,readOnly:!n,onChange:r=>{n&&J(r)}})]}),e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col",children:[e.jsx("label",{htmlFor:"cashNumber",children:a.language==="ar"?"رقم المحفظة الالكترونية":"Cash Number"}),e.jsx("input",{className:"w-full bg-gray-300",id:"cashNumber",type:"tel",value:n?F:l.cash_number,readOnly:!n,onChange:r=>{n&&we(r)}})]}),e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col",children:[e.jsx("label",{htmlFor:"email",children:a.language==="ar"?"المحافظة":"Governorate"}),n?e.jsx(Se,{name:"governorate",id:"governorate",className:"rounded-lg border-gray-300 shadow-md col-span-2",onChange:r=>be(r.value),options:a.language==="en"?ye:Ne,placeholder:a.language==="ar"?"ادخل محافظتك":"enter your Governorate",isRtl:a.language==="ar",readOnly:!n,isSearchable:!0,required:!0}):e.jsx("input",{className:"w-full bg-gray-300",id:"governorate",type:"text",value:a.language==="en"?s==null?void 0:s.title.en:s==null?void 0:s.title.ar,readOnly:!n,onChange:r=>{n&&J(r)}})]}),n&&e.jsxs("div",{className:"w-full grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:_,className:"m-0 bg-secondColor py-2 rounded-xl text-white",type:"submit",children:Q?e.jsx(w,{"aria-label":"loading...",color:"purple"}):a.language==="ar"?"حفظ التعديلات":"Save Changes"}),e.jsx("button",{className:"py-2 rounded-xl border border-secondColor text-secondColor",type:"button",onClick:L,children:a.language==="ar"?"الغاء":"Cancel"})]})]}),B&&e.jsxs("form",{className:"flex flex-col gap-5 items-center my-5",onSubmit:$,children:[e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col relative",children:[e.jsx("label",{htmlFor:"new-password",children:a.language==="ar"?"كلمة المرور الجديده":"New Password"}),e.jsx("input",{className:"w-full bg-gray-300",id:"new-password",type:f?"text":"password",value:y,onChange:X}),f?e.jsx(oe,{className:`absolute ${a.language==="en"?"right-3":"left-3"} top-1/2 transform translate-y-1/2 cursor-pointer`,onClick:O}):e.jsx(re,{className:`absolute ${a.language==="en"?"right-3":"left-3"} top-1/2 transform translate-y-1/2 cursor-pointer`,onClick:O})]}),e.jsxs("div",{className:"flex w-full gap-2 justify-between flex-col relative",children:[e.jsx("label",{htmlFor:"confirm-password",children:a.language==="ar"?"اعد كتابة كلمة المرور":"Confirm Password"}),e.jsx("input",{className:"w-full bg-gray-300",id:"confirm-password",type:f?"text":"password",value:N,onChange:Y})]}),e.jsxs("div",{className:"w-full grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:$,className:"m-0 bg-secondColor py-2 rounded-xl text-white",type:"submit",children:H?e.jsx(w,{"aria-label":"loading...",color:"purple"}):a.language==="ar"?"حفظ كلمة المرور":"Uptade Password"}),e.jsx("button",{className:"py-2 rounded-xl border border-secondColor text-secondColor",type:"button",onClick:T,children:a.language==="ar"?"الغاء":"Cancel"})]})]})]})]})]})}};export{Be as default};
