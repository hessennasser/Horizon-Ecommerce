import{u as D,r as u,n as L,j as e,F as w,Q as p,a2 as A,i as E}from"./index-acb0ca69.js";import{L as d,F as B,T as m,S as z}from"./Tooltip-0d983042.js";import{S as U}from"./react-select.esm-7c18320e.js";import"./index.esm-602758c1.js";import"./floating-ui.dom-9d44cd4e.js";import"./toConsumableArray-94af18ff.js";import"./emotion-unitless.esm-475d8cc4.js";const X=({addModal:$,setAddModal:g,setSelectedGovernorate:O,encategoriesOptions:C,arcategoriesOptions:_,getSellerProducts:j,setAllProducts:v,setIsLoading:k})=>{const{i18n:s}=D(),{mainRequest:q,removeBackground:Q}=u.useContext(L),F=JSON.parse(localStorage.getItem("sellerToken")),P=async({title_ar:a,title_en:l,start_date:n,category:r,quantity:h,price:x,images:f},N,R)=>{N(!0);try{const o=new A;o.append("token",F),o.append("title_ar",a),o.append("title_en",l),o.append("category_id",r==null?void 0:r.value),o.append("quantity",h),o.append("price",x),o.append("start_date",n),o.append("images",f[0],f[0].name);const G=await q.post(`${E}/vendor/products/create`,o,{headers:{accept:"application/json","Content-Type":"multipart/form-data"}});p.success(s.language==="en"?"The product has been uploaded":"تم رفع المنتج بنجاح"),j(v)}catch(o){console.log(o),p.error(s.language==="en"?"There is an error, please try again later":"يوجد خطأ ما، الرجاء المحاولة مرة أخرى")}finally{N(!1),R(!1),j(v,k)}},[t,c]=u.useState({image:null,title_en:"",title_ar:"",category:null,quantity:"",price:"",start_date:""}),[i,b]=u.useState([]),[y,S]=u.useState(!1),T=()=>{if(!i||i.length===0||!t.title_ar||!t.category||!t.quantity||!t.price||!t.start_date){p.error(s.language==="en"?"Please enter all required fields":"برجاء إدخال جميع الحقول المطلوبة");return}const a=[],l=[];for(let n=0;n<(i==null?void 0:i.length);n++){const r=new FileReader;a.push(new Promise(h=>{r.onloadend=()=>{const x=new Blob([r.result],{type:i[n].type});l.push(x),h()}})),r.readAsArrayBuffer(i[n])}Promise.all(a).then(()=>{var r;const n={...t,title_en:((r=t.title_en)==null?void 0:r.trim())||t.title_ar.trim(),images:l};P(n,S,g)})},I=a=>{const l=[...i];l.splice(a,1),b(l)};return e.jsx("div",{className:"fixed z-[10000] inset-0 overflow-y-auto",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen px-4 pt-4 pb-20 sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:e.jsx("div",{className:"absolute inset-0 bg-gray-500 bg-opacity-90"})}),e.jsxs("div",{className:"modal-app relative bg-white rounded-lg overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[e.jsxs("div",{className:"sticky z-10 top-0 left-0 right-0 bg-white px-4 py-2 shadow-md flex justify-between",children:[e.jsx("h3",{className:"text-xl font-medium text-secondColor",children:s.language==="en"?"Add Product":"اضافة منتج جديد"}),e.jsx("button",{className:"border border-secondColor text-secondColor py-1 px-4 rounded-md hover:brightness-110",onClick:()=>{g(!1)},children:e.jsx(w,{})})]}),e.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 flex items-center justify-center",children:e.jsxs("div",{className:"space-y-6 w-full grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(d,{htmlFor:"image",value:s.language==="en"?"Image *":"الصوره *"})}),e.jsx(B,{id:"image",required:!0,multiple:!0,accept:"image/*",onChange:a=>{const l=a.target.files,n=[...i];for(let r=0;r<l.length;r++){if(n.length>=4){p.error(s.language==="en"?"You can only upload up to 4 photos":"يمكنك تحميل ما يصل إلى 4 صور فقط");break}n.push(l[r])}b(n)}})]}),e.jsx("div",{className:"col-span-2",children:i.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 justify-center",children:i.map((a,l)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:URL.createObjectURL(a),alt:`Image ${l}`,className:"h-20 w-20 object-cover rounded-md"}),e.jsx("button",{className:"absolute top-0 right-0 text-red-600 p-1 bg-white rounded-full hover:bg-red-100",onClick:()=>I(l),children:e.jsx(w,{})})]},l))})}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(d,{htmlFor:"title_en",value:s.language==="en"?"Product Name English":"اسم المنتج بالانجليزية"})}),e.jsx(m,{id:"title_en",type:"text",value:t.title_en,onChange:a=>c({...t,title_en:a.target.value})})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(d,{htmlFor:"title_ar",value:s.language==="en"?"Product Name Arabic *":"اسم المنتج بالعربية *"})}),e.jsx(m,{id:"title_ar",type:"text",required:!0,value:t.title_ar,onChange:a=>c({...t,title_ar:a.target.value})})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(d,{htmlFor:"category",value:s.language==="en"?"Product Category *":"تصنيف المنتج *"})}),e.jsx(U,{name:"category",id:"category",className:"w-full",options:s.language==="en"?C:_,placeholder:s.language==="en"?"Product Category":"تصنيف المنتج",isRtl:s.language==="ar",isSearchable:!0,required:!0,value:t.category,onChange:a=>c({...t,category:a})})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(d,{htmlFor:"quantity",value:s.language==="en"?"Quantity *":"* الكمية"})}),e.jsx(m,{id:"quantity",type:"number",min:1,required:!0,value:t.quantity,onChange:a=>c({...t,quantity:a.target.value})})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(d,{htmlFor:"Price",value:s.language==="en"?"Price *":" *السعر"})}),e.jsx(m,{id:"Price",type:"number",min:1,required:!0,value:t.price,onChange:a=>c({...t,price:a.target.value})})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"mb-2 block",children:e.jsx(d,{htmlFor:"expiry-date",value:s.language==="en"?"Expiry date *":"تاريخ الانتهاء *"})}),e.jsx(m,{id:"expiry-date",type:"date",required:!0,value:t.start_date,onChange:a=>c({...t,start_date:a.target.value})})]})]})}),e.jsxs("div",{className:" sticky z-10 bottom-0 left-0 right-0 bg-gray-50 px-4 py-3 shadow-md flex items-center gap-2",children:[e.jsx("button",{className:"bg-secondColor py-1 px-4 rounded-md hover:brightness-110 text-white mx-2",onClick:T,disabled:y,children:y?e.jsx(z,{"aria-label":"loading...",color:"purple"}):s.language==="en"?"Save":"حفظ"}),e.jsx("button",{className:"border border-secondColor text-secondColor py-1 px-4 rounded-md hover:brightness-110",onClick:()=>{g(!1)},children:s.language==="en"?"Cancel":"الغاء"}),e.jsx("span",{className:"text-xs text-red-600 font-bold",children:s.language==="en"?"Please Enter All Data*":"برجاء ادخال جميع البيانات المطلوبه*"})]})]})]})})};export{X as default};
