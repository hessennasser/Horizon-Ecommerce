import{u as D,j as e,g as W,r as o,f as K,O as V,a4 as X,S as Z,Q as h,b as ee}from"./index-a3ee0e6e.js";/* empty css              */const ae=({title:u,price:a,productTotalPrice:p,quantity:y,image:m})=>{const{i18n:d}=D();return e.jsxs("div",{className:"flex justify-between gap-3 border border-gray-300 py-3 px-2 rounded-md shadow-sm",children:[e.jsx("img",{className:"w-20 h-20 object-cover",src:m,alt:d.language==="en"?u.en:u.ar}),e.jsxs("div",{className:"grid flex-1 gap-5",children:[e.jsx("h3",{className:"font-medium",children:d.language==="en"?u.en:u.ar}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("p",{className:"text-gray-500",children:[d.language==="en"?"Quantity : ":"الكمية : ",e.jsx("span",{children:y})]}),e.jsx("span",{children:"*"}),e.jsxs("p",{className:"text-gray-500",children:[d.language==="en"?"Price : ":"السعر : ",e.jsx("span",{children:a})]})]})]}),e.jsx("span",{className:"text-secondColor font-bold",children:`${d.language==="ar"?`جنية ${p}`:`${p} EGY`}`})]})},se=()=>{var O,S;const u=W(),{i18n:a}=D(),[p,y]=o.useState([]),m=JSON.parse(localStorage.getItem("userToken")),d=localStorage.getItem("userLogged"),[s,G]=o.useState({});if(!d)return u("/customer-login"),null;const[C,T]=o.useState(""),[r,b]=o.useState({firstName:((O=s==null?void 0:s.name)==null?void 0:O.split(" ")[0])||"",lastName:((S=s==null?void 0:s.name)==null?void 0:S.split(" ").slice(1).join(" "))||"",phoneNumber:(s==null?void 0:s.phone)||"",email:(s==null?void 0:s.email)||"",address:"",apartment:"",floor:"",street:"",building:"",selectedPaymentMethod:"vodafone-cash",notes:""}),[j,w]=o.useState(null),[x,R]=o.useState(null),{getCartItems:P,getTotalPriceInCart:k,total:N,governorates:q,getGovernorates:L,mainRequest:U,setCartItems:$,getUserInfo:I,chosenDelivery:Y}=o.useContext(K),F=o.useRef(null),i=n=>{b({...r,[n.target.name]:n.target.value})},M=n=>{b({...r,selectedPaymentMethod:n.target.value})},z=n=>{const t=n.target.files[0];w(t)},A=()=>{F.current.click()},J=()=>{w(null)},[Q,g]=o.useState(!1),E=async n=>{n.preventDefault();const t={...r,governorate_id:C.value,city:C.label,token:m},f=/^(010|011|012|015)[0-9]{8}$/;if(r.selectedPaymentMethod==="vodafone-cash"&&!x){h.info(a.language==="en"?"Please enter your cash number":"من فضلك أدخل رقم المحفظة الالكترونية"),g(!1);return}if(r.selectedPaymentMethod==="vodafone-cash"&&!f.test(x)){h.info(a.language==="en"?"Wallet number should be 11 digits and start with 010, 011, 012, or 015.":"يجب أن يتكون رقم المحفظة من 11 رقمًا ويبدأ بـ 010 أو 011 أو 012 أو 015.");return}if(!f.test(t.phoneNumber)){h.info(a.language==="en"?"Phone number should be 11 digits and start with 010, 011, 012, or 015.":"يجب أن يتكون رقم الهاتف من 11 رقمًا ويبدأ بـ 010 أو 011 أو 012 أو 015.");return}g(!0);const l=new FormData;if(l.append("token",t.token),l.append("first_name",t.firstName),l.append("last_name",t.lastName),l.append("phone",t.phoneNumber),l.append("email",t.email),l.append("address",t.address),l.append("apartment",t.apartment),l.append("floor",t.floor),l.append("street",t.street),l.append("building",t.building),l.append("governorate_id",t.governorate_id),l.append("city",t.city),l.append("notes",t.notes),l.append("payment_method",t.selectedPaymentMethod==="cash-on-delivery"?0:1),l.append("vodafone_cash_number",x),l.append("charging",Y==="Fast delivery"?"fast":"normal"),l.append("photo",j),!Object.values(t).every(c=>c)&&t.selectedPaymentMethod!=="cash-on-delivery"){h.info(a.language==="en"?"Please fill all fields":"من فضلك ادخل جميع البيانات"),g(!1);return}const v=["vodafone_cash_number","photo"];if(t.selectedPaymentMethod==="cash-on-delivery"&&!Object.entries(t).filter(([c,_])=>!v.includes(c)).every(([c,_])=>_)){h.info(a.language==="en"?"Please fill all fields":"من فضلك ادخل جميع البيانات"),g(!1);return}try{const c=await U.post(`${ee}/payment`,l);h.success(a.language==="en"?"Your Oreder Succsesfly Done":"تم ارسال طلبك بنجاح"),u("/"),g(!1)}catch(c){console.log(c),h.error(a.language==="en"?"Something went wrong":"حدث خطأ ما, من فضلك حاول مرة اخري"),g(!1)}finally{g(!1),k(),P(m,$)}};o.useEffect(()=>{d&&m&&(k(),P(m,y))},[d,m,N]),o.useEffect(()=>{var n,t;d&&I(m,G),b({...r,firstName:((n=s==null?void 0:s.name)==null?void 0:n.split(" ")[0])||"",lastName:((t=s==null?void 0:s.name)==null?void 0:t.split(" ").slice(1).join(" "))||"",phoneNumber:s.phone,email:s.email})},[d,m,s.name]);const B=q.map(n=>({value:n.id,label:n.title.en})),H=q.map(n=>({value:n.id,label:n.title.ar}));return o.useEffect(()=>{L()},[]),e.jsxs("div",{className:"container py-10",children:[Q&&e.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-[#F4F4F4] bg-opagovernorate_id-60 z-50",children:e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:e.jsx(V,{visible:!0,height:"260",width:"260",ariaLabel:"Oval-loading",wrapperStyle:{},wrapperClass:"Oval-wrapper",color:"#125ed4",secondaryColor:"#060047"})})}),e.jsxs("form",{onSubmit:E,className:"grid grid-cols-1 lg:grid-cols-2 gap-6 relative",children:[e.jsxs("div",{className:"grid gap-3 lg:sticky top-0 right-0 h-fit",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-mainColor font-bold text-lg",children:a.language==="en"?"Payment Method":"طريقة الدفع"}),e.jsx("p",{className:"text-gray-500",children:a.language==="en"?"Choose the appropriate payment method for you and complete the information":"اختر طريقة الدفع المناسبه لك واكمل البيانات"})]}),e.jsxs("div",{className:"flex justify-between items-center rounded-lg border border-gray-500 p-2",children:[e.jsx("label",{className:"flex-1 cursor-pointer",htmlFor:"vodafone-cash",children:a.language==="en"?"Electronic wallets":"المحافظ الالكترونية"}),e.jsx("input",{className:"cursor-pointer",type:"radio",name:"selectedPaymentMethod",id:"vodafone-cash",value:"vodafone-cash",checked:r.selectedPaymentMethod==="vodafone-cash",onChange:M})]}),e.jsxs("div",{className:"flex justify-between items-center rounded-lg border border-gray-500 p-2",children:[e.jsx("label",{className:"flex-1 cursor-pointer",htmlFor:"cash-on-delivery",children:a.language==="en"?"Paiement when recieving":"الدفع عند الاستلام"}),e.jsx("input",{className:"cursor-pointer",type:"radio",name:"selectedPaymentMethod",id:"cash-on-delivery",value:"cash-on-delivery",checked:r.selectedPaymentMethod==="cash-on-delivery",onChange:M})]})]}),r.selectedPaymentMethod!=="cash-on-delivery"&&e.jsxs("div",{className:"flex flex-col gap-3 mt-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-mainColor font-bold text-lg",children:a.language==="en"?"Transfer data":"بيانات الدفع"}),e.jsx("p",{className:"text-gray-500",children:a.language==="en"?"Enter the required data below and make sure the image is clear":"ادخل البيانات المطلوبه بالاسفل وتأكد من وضوح الصوره"})]}),e.jsxs("div",{className:"flex items-center flex-col gap-2 justify-center",children:[e.jsxs("div",{className:"w-full flex gap-2 flex-col",children:[e.jsx("label",{htmlFor:"cashNumber",className:"my-2 text-xl font-bold",children:a.language==="en"?"Enter the wallet number":"أدخل رقم المحفظة"}),e.jsx("input",{placeholder:a.language==="ar"?"رقم المفظة الالكترونية":"Cash Number",className:"rounded-lg border-gray-300 shadow-md",type:"tel",id:"cashNumber",name:"cashNumber",value:x,onChange:n=>{R(n.target.value)},required:!0})]}),e.jsx("label",{htmlFor:"photoInput",className:"w-full my-2 text-xl font-bold",children:a.language==="en"?"Transfer receipt":"إيصال التحويل"}),e.jsxs("div",{className:"w-2/3 bg-[#F8F8FF] text-center border-dashed border-2 rounded-lg border-gray-300 p-4",children:[j?e.jsxs("div",{children:[e.jsx("img",{src:URL.createObjectURL(j),alt:"Transfer photo",className:"w-20 h-20 mx-auto mb-2"}),e.jsx("span",{className:"text-secondColor font-bold border-b border-b-secondColor",children:"Photo Selected"}),e.jsxs("div",{className:"flex justify-center mt-2",children:[e.jsx("button",{type:"button",className:"bg-mainColor text-white py-1 px-2 rounded-lg mr-2",onClick:A,children:"Update Photo"}),e.jsx("button",{type:"button",className:"bg-red-500 text-white py-1 px-2 rounded-lg",onClick:J,children:"Delete Photo"})]})]}):e.jsxs("label",{htmlFor:"photoInput",className:"flex flex-col items-center justify-center cursor-pointer",children:[e.jsx(X,{className:"text-[4rem]"}),e.jsx("span",{className:"text-secondColor font-bold border-b border-b-secondColor cursor-pointer",children:"Select Photo"})]}),e.jsx("input",{ref:F,id:"photoInput",type:"file",accept:".jpg,.jpeg,.png",className:"hidden",onChange:z,required:r.selectedPaymentMethod!=="cash-on-delivery"}),e.jsxs("p",{className:"text-gray-500 mt-2",children:[a.language==="en"?"Supported formats":"الإمتدادات المدعومه",": JPEG, PNG"]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-mainColor font-bold text-lg",children:a.language==="en"?"Personal Details":"البيانات الشخصية"}),e.jsx("p",{className:"text-gray-500",children:a.language==="en"?"Complete personal details to continue the payment":"أكمل التفاصيل الشخصية لمواصلة الدفع"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[e.jsx("input",{placeholder:a.language==="en"?"First Name":"الاسم الاول",className:"rounded-lg border-gray-300 shadow-md",type:"text",name:"firstName",value:r.firstName,onChange:i,required:!0}),e.jsx("input",{placeholder:a.language==="en"?"Last Name":"الاسم الاخير",className:"rounded-lg border-gray-300 shadow-md",type:"text",name:"lastName",value:r.lastName,onChange:i,required:!0}),e.jsx("input",{placeholder:a.language==="en"?"Phone Number":"رقم الهاتف",className:"rounded-lg border-gray-300 shadow-md",type:"tel",name:"phoneNumber",value:r.phoneNumber,onChange:i,required:!0}),e.jsx("input",{placeholder:a.language==="en"?"Email":"البريد الالكتروني",className:"rounded-lg border-gray-300 shadow-md",type:"email",name:"email",value:r.email,onChange:i,required:!0}),e.jsx(Z,{name:"governorate",id:"governorate",className:"rounded-lg border-gray-300 shadow-md col-span-2",onChange:n=>T(n),options:a.language==="en"?B:H,placeholder:a.language==="ar"?"ادخل محافظتك":"enter your Governorate",isRtl:a.language==="ar",isSearchable:!0,required:!0}),e.jsx("input",{placeholder:a.language==="ar"?"عنوانك":"Address",className:"rounded-lg border-gray-300 shadow-md col-span-2",type:"text",name:"address",value:r.address,onChange:i,required:!0}),e.jsx("input",{placeholder:a.language==="ar"?"الشارع":"Street",className:"rounded-lg border-gray-300 shadow-md col-span-2",type:"text",name:"street",value:r.street,onChange:i,required:!0}),e.jsxs("div",{className:"grid col-span-2 grid-cols-3 gap-2",children:[e.jsx("input",{placeholder:a.language==="ar"?"المبنى":"Building",className:"rounded-lg border-gray-300 shadow-md",type:"text",name:"building",value:r.building,onChange:i,required:!0}),e.jsx("input",{placeholder:a.language==="ar"?"الشقة":"floor",className:"rounded-lg border-gray-300 shadow-md",type:"text",name:"floor",value:r.floor,onChange:i,required:!0}),e.jsx("input",{placeholder:a.language==="ar"?"الشقة":"Apartment",className:"rounded-lg border-gray-300 shadow-md",type:"text",name:"apartment",value:r.apartment,onChange:i,required:!0})]}),e.jsx("textarea",{name:"notes",id:"notes",value:r.notes,onChange:i,placeholder:a.language==="en"?"enter short note":"اترك ملاحظة",className:"rounded-lg border-gray-300 shadow-md col-span-2 resize-y min-h-[5rem] max-h-[10rem]"})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 sticky top-44 left-0 h-fit",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-mainColor font-bold text-lg",children:a.language==="en"?"Current Order":"الطلب الحالي"}),e.jsx("p",{className:"text-gray-500",children:a.language==="en"?"The sum of all total payments for your current order":"مجموع المدفوعات الإجمالية لطلبك الحالي"})]}),p.map(n=>{const{id:t,title:f,images:l,price:v,quantity_of_cart:c}=n;return e.jsx(ae,{quantity:c.quantity,title:f,price:v,productTotalPrice:c.total,image:`https://admin.horriizon.com/public/${l[0].path}`},t)}),e.jsxs("div",{className:"flex justify-between items-center font-medium py-4 border-dotted border-b-2",children:[e.jsx("h6",{children:a.language==="en"?"total summation":"المجموع الكلي"}),e.jsxs("p",{children:[N," EGY"]})]}),e.jsxs("button",{type:"submit",className:"bg-secondColor text-white text-xl py-2 px-4 rounded-md",onClick:E,children:[a.language==="en"?"Pay":"إدفع"," ",N," EGY"]})]})]})]})};export{se as default};
